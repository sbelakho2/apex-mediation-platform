name: security-scan

on:
  push:
  pull_request:

jobs:
  snyk-node:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install Snyk
        run: npm install -g snyk@latest
      - name: Auth Snyk
        if: ${{ secrets.SNYK_TOKEN != '' }}
        run: snyk auth $SNYK_TOKEN
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
      - name: Monitor (non-blocking)
        continue-on-error: true
        run: snyk monitor --org=default || true
